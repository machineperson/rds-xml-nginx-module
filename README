Name
    ngx_rds_xml - an output filter that formats Resty
        DBD Streams generated by ngx_drizzle and others to XML

Status
    This module is considered production ready.

    We need your help! If you find this module useful and/or
    interesting, please consider joining the development!
    Commit bit can be freely delivered at your request ;)

Synopsis

   server {
        location /mysql {
            drizzle_query 'select * from cats';
            drizzle_pass my_mysql_upstream;

            rds_xml on;
        }

        location /foo {
            if ($arg_limit !~ '^\d{2}$') {
                rds_xml_ret 400 'Bad "limit" argument';
            }

            drizzle_query "select * from dogs limit $arg_limit";
            drizzle_pass my_mysql_upstream;

            rds_xml on;
        }
        ...
    }

Description
    This module provides an output filter that can format the RDS outputs
    generated by ngx_drizzle and ngx_postgres modules to XML.

Directives
    rds_xml
        syntax: rds_xml  on|off
        default: rds_xml off

        Enables or disables the output filter of this module.

    rds_xml_buffer_size
        syntax: rds_xml_buffer_size   <bytes>
        default: rds_xml_buffer_size <page-size>

        Controls the buffer size used by this module. default to the page size (4k/8k).
        The bigger the buffer size, the less streammy the conversion
        will be. But usually increasing the buffer size
        does help reduce CPU time.

    rds_xml_format
        syntax: rds_xml_format  normal|compact
        default: rds_xml_format normal

    rds_xml_root
        syntax: rds_xml_root <key>
        default: no

        Specify the "root" key for data rows (if any).

        If this directive is not defined, neither are rds_xml_success_property,
        nor rds_xml_extra_property, the XML output for select queries will
        just be an array at the
        top level.

        When either rds_xml_success_property or rds_xml_extra_property are specified,
        this directive takes a default argument of "data".

    rds_xml_success_property
        syntax: rds_xml_success_property <key>
        default: no

        Specify the top-level object property name used in the XML output
        for indicating success or false of the query.

    rds_xml_user_property
        syntax: rds_xml_user_property <key> <value>
        default: no

        Specify additonal user properties for the top-level object
        of the XML output.

        Multiple instances of this directives are allowed in a single scope.

        Nginx variables are supported in the <value> argument.

        Both of the <key> and <value> arguments will be automatically
        quoted according to XML strings' notation.

    rds_xml_errcode_key
        syntax: rds_xml_errcode_key <key>
        default: rds_xml_errcode_key errcode

        Specify the errcode key name used in the XML output.

    rds_xml_errstr_key
        syntax: rds_xml_errstr_key <key>
        default: rds_xml_errstr_key errstr

        Specify the errstr key name used in the XML output.

    rds_xml_ret
        syntax: rds_xml_ret <error-code> <descrption>
        default: no

    rds_xml_content_type
        syntax: rds_xml_content_type <mime-type>
        default: rds_xml_content_type application/json

        Controls the Content-Type header of the response generated by
        this module's output filter.

Installation
    Grab the nginx source code from nginx.net (<http://nginx.net/ >), for
    example, the version 1.4.4 (see nginx compatibility), and then build
    the source with this module:

        wget 'http://nginx.org/download/nginx-1.4.4.tar.gz'
        tar -xzvf nginx-1.4.4.tar.gz
        cd nginx-1.4.4/

        # Here we assume you would install you nginx under /opt/nginx/.
        ./configure --prefix=/opt/nginx \
            --add-module=/path/to/drizzle-nginx-module
            --add-module=/path/to/rds-xml-nginx-module

        make -j2
        make install

    Download the latest version of the release tarball of this module from
    rds-xml-nginx-module file list
    (<http://github.com/machinelady/rds-xml-nginx-module/tags >).

Compatibility
    The following versions of Nginx should work with this module:

    *   1.4.x (last tested: 1.4.4)

    *   1.2.x (last tested: 1.2.9)

    *   1.1.x (last tested: 1.1.5)

    *   1.0.x (last tested: 1.0.9)

    *   0.9.x (last tested: 0.9.4)

    *   0.8.x (last tested: 0.8.55)

    *   0.7.x >= 0.7.46 (last tested: 0.7.68)

    Earlier versions of Nginx like 0.6.x and 0.5.x will *not* work.

    If you find that any particular version of Nginx above 0.7.44 does not
    work with this module, please consider reporting a bug.

TODO

Known Issues

See Also

    * ngx_drizzle ( http://github.com/chaoslawful/drizzle-nginx-module )

    * ngx_postgres ( http://github.com/FRiCKLE/ngx_postgres/ )

Author
    Nadja Deininger <nadja at ef dot gy>
    Fork of the rds-json-nginx-module from the Openresty project
    ( https://github.com/openresty/rds-json-nginx-module )

Copyright & License
    This module is licenced under the BSD license.

    Copyright (C) 2009-2013, Yichun Zhang (agentzh) <agentzh@gmail.com>, CloudFlare Inc.

    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:

        * Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

        * Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
